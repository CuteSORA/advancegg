<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blending & Compositing API - AdvanceGG</title>
    <meta name="description" content="Complete blending and compositing API reference for AdvanceGG including 13 blend modes and layer management.">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/style.css" rel="stylesheet">
    <style>
        .blend-mode-card {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .blend-mode-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .blend-preview {
            width: 100px;
            height: 60px;
            border-radius: 4px;
            border: 1px solid #dee2e6;
            margin-bottom: 1rem;
        }
        .api-method {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 1rem;
            margin-bottom: 1rem;
            font-family: 'JetBrains Mono', monospace;
        }
        .code-example {
            background: #2d3748;
            color: #e2e8f0;
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1rem 0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
        }
        .blend-formula {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 1rem;
            margin: 1rem 0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
        <div class="container">
            <a class="navbar-brand fw-bold" href="../index.html">
                ðŸŽ¨ AdvanceGG
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../getting-started.html">Getting Started</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../examples/index.html">Examples</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="index.html">API Reference</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/GrandpaEJ/advancegg" target="_blank">GitHub</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container py-5">
        <h1 class="display-5 fw-bold mb-4">Blending & Compositing API</h1>
        <p class="lead mb-5">
            Professional layer compositing system with 13 blend modes for advanced graphics composition, matching industry-standard tools like Photoshop.
        </p>

        <!-- Layer Management -->
        <section class="mb-5">
            <h2 class="h3 fw-bold mb-4">Layer Management</h2>
            
            <div class="api-method">
                <strong>EnableLayers()</strong><br>
                <span class="text-muted">Enables the layer system for the current context</span>
            </div>

            <div class="api-method">
                <strong>GetLayerManager() *LayerManager</strong><br>
                <span class="text-muted">Returns the layer manager for the current context</span>
            </div>

            <div class="api-method">
                <strong>AddLayer(name string) *Layer</strong><br>
                <span class="text-muted">Creates and adds a new layer with the specified name</span>
            </div>

            <div class="api-method">
                <strong>SetActiveLayer(index int)</strong><br>
                <span class="text-muted">Sets the active layer for drawing operations</span>
            </div>

            <div class="code-example">
<pre><code>// Enable layer system
dc.EnableLayers()
lm := dc.GetLayerManager()

// Create layers
backgroundLayer := lm.GetActiveLayer()
backgroundLayer.Name = "Background"

overlayLayer := lm.AddLayer("Overlay")
overlayLayer.SetBlendMode(advancegg.BlendModeMultiply)
overlayLayer.SetOpacity(0.8)

// Draw on specific layers
lm.SetActiveLayer(0) // Background
dc.SetRGB(0.2, 0.4, 0.8)
dc.DrawRectangle(0, 0, 400, 300)
dc.Fill()

lm.SetActiveLayer(1) // Overlay
dc.SetRGB(1, 0.3, 0.3)
dc.DrawCircle(200, 150, 100)
dc.Fill()

// Composite all layers
result := lm.Composite()</code></pre>
            </div>
        </section>

        <!-- Blend Modes -->
        <section class="mb-5">
            <h2 class="h3 fw-bold mb-4">Blend Modes</h2>
            <p class="mb-4">AdvanceGG supports 13 professional blend modes with accurate color mathematics:</p>
            
            <div class="row">
                <!-- Normal -->
                <div class="col-md-6 col-lg-4">
                    <div class="blend-mode-card">
                        <div class="blend-preview" style="background: linear-gradient(45deg, #ff6b6b 50%, #4ecdc4 50%);"></div>
                        <h5>Normal</h5>
                        <p class="text-muted small">Default blending mode. Top layer completely covers bottom layer.</p>
                        <code>BlendModeNormal</code>
                        <div class="blend-formula">
                            Result = Source
                        </div>
                    </div>
                </div>

                <!-- Multiply -->
                <div class="col-md-6 col-lg-4">
                    <div class="blend-mode-card">
                        <div class="blend-preview" style="background: linear-gradient(45deg, #8B4513 50%, #2F4F4F 50%);"></div>
                        <h5>Multiply</h5>
                        <p class="text-muted small">Multiplies colors, resulting in darker output. White has no effect.</p>
                        <code>BlendModeMultiply</code>
                        <div class="blend-formula">
                            Result = Source Ã— Destination
                        </div>
                    </div>
                </div>

                <!-- Screen -->
                <div class="col-md-6 col-lg-4">
                    <div class="blend-mode-card">
                        <div class="blend-preview" style="background: linear-gradient(45deg, #FFB6C1 50%, #98FB98 50%);"></div>
                        <h5>Screen</h5>
                        <p class="text-muted small">Inverts, multiplies, and inverts again. Results in lighter output.</p>
                        <code>BlendModeScreen</code>
                        <div class="blend-formula">
                            Result = 1 - (1-S) Ã— (1-D)
                        </div>
                    </div>
                </div>

                <!-- Overlay -->
                <div class="col-md-6 col-lg-4">
                    <div class="blend-mode-card">
                        <div class="blend-preview" style="background: linear-gradient(45deg, #FF8C00 50%, #20B2AA 50%);"></div>
                        <h5>Overlay</h5>
                        <p class="text-muted small">Combines multiply and screen. Enhances contrast.</p>
                        <code>BlendModeOverlay</code>
                        <div class="blend-formula">
                            If D &lt; 0.5: 2Ã—SÃ—D<br>
                            Else: 1-2Ã—(1-S)Ã—(1-D)
                        </div>
                    </div>
                </div>

                <!-- Soft Light -->
                <div class="col-md-6 col-lg-4">
                    <div class="blend-mode-card">
                        <div class="blend-preview" style="background: linear-gradient(45deg, #DDA0DD 50%, #F0E68C 50%);"></div>
                        <h5>Soft Light</h5>
                        <p class="text-muted small">Subtle lighting effect. Darkens or lightens based on source.</p>
                        <code>BlendModeSoftLight</code>
                        <div class="blend-formula">
                            Complex formula using<br>
                            dodge and burn operations
                        </div>
                    </div>
                </div>

                <!-- Hard Light -->
                <div class="col-md-6 col-lg-4">
                    <div class="blend-mode-card">
                        <div class="blend-preview" style="background: linear-gradient(45deg, #B22222 50%, #228B22 50%);"></div>
                        <h5>Hard Light</h5>
                        <p class="text-muted small">Strong lighting effect. Like overlay but with source and destination swapped.</p>
                        <code>BlendModeHardLight</code>
                        <div class="blend-formula">
                            If S &lt; 0.5: 2Ã—SÃ—D<br>
                            Else: 1-2Ã—(1-S)Ã—(1-D)
                        </div>
                    </div>
                </div>

                <!-- Color Dodge -->
                <div class="col-md-6 col-lg-4">
                    <div class="blend-mode-card">
                        <div class="blend-preview" style="background: linear-gradient(45deg, #FFE4B5 50%, #E0FFFF 50%);"></div>
                        <h5>Color Dodge</h5>
                        <p class="text-muted small">Brightens destination based on source. Creates bright, saturated colors.</p>
                        <code>BlendModeColorDodge</code>
                        <div class="blend-formula">
                            Result = D / (1 - S)
                        </div>
                    </div>
                </div>

                <!-- Color Burn -->
                <div class="col-md-6 col-lg-4">
                    <div class="blend-mode-card">
                        <div class="blend-preview" style="background: linear-gradient(45deg, #8B0000 50%, #000080 50%);"></div>
                        <h5>Color Burn</h5>
                        <p class="text-muted small">Darkens destination based on source. Creates dark, saturated colors.</p>
                        <code>BlendModeColorBurn</code>
                        <div class="blend-formula">
                            Result = 1 - (1-D) / S
                        </div>
                    </div>
                </div>

                <!-- Darken -->
                <div class="col-md-6 col-lg-4">
                    <div class="blend-mode-card">
                        <div class="blend-preview" style="background: linear-gradient(45deg, #696969 50%, #2F4F4F 50%);"></div>
                        <h5>Darken</h5>
                        <p class="text-muted small">Selects the darker of the two colors for each pixel.</p>
                        <code>BlendModeDarken</code>
                        <div class="blend-formula">
                            Result = min(S, D)
                        </div>
                    </div>
                </div>

                <!-- Lighten -->
                <div class="col-md-6 col-lg-4">
                    <div class="blend-mode-card">
                        <div class="blend-preview" style="background: linear-gradient(45deg, #F5F5DC 50%, #F0F8FF 50%);"></div>
                        <h5>Lighten</h5>
                        <p class="text-muted small">Selects the lighter of the two colors for each pixel.</p>
                        <code>BlendModeLighten</code>
                        <div class="blend-formula">
                            Result = max(S, D)
                        </div>
                    </div>
                </div>

                <!-- Difference -->
                <div class="col-md-6 col-lg-4">
                    <div class="blend-mode-card">
                        <div class="blend-preview" style="background: linear-gradient(45deg, #FF1493 50%, #00CED1 50%);"></div>
                        <h5>Difference</h5>
                        <p class="text-muted small">Subtracts colors, creating high contrast effects.</p>
                        <code>BlendModeDifference</code>
                        <div class="blend-formula">
                            Result = |S - D|
                        </div>
                    </div>
                </div>

                <!-- Exclusion -->
                <div class="col-md-6 col-lg-4">
                    <div class="blend-mode-card">
                        <div class="blend-preview" style="background: linear-gradient(45deg, #DA70D6 50%, #7FFFD4 50%);"></div>
                        <h5>Exclusion</h5>
                        <p class="text-muted small">Similar to difference but with lower contrast.</p>
                        <code>BlendModeExclusion</code>
                        <div class="blend-formula">
                            Result = S + D - 2Ã—SÃ—D
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Layer Properties -->
        <section class="mb-5">
            <h2 class="h3 fw-bold mb-4">Layer Properties</h2>
            
            <div class="api-method">
                <strong>SetBlendMode(mode BlendMode)</strong><br>
                <span class="text-muted">Sets the blend mode for the layer</span>
            </div>

            <div class="api-method">
                <strong>SetOpacity(opacity float64)</strong><br>
                <span class="text-muted">Sets the layer opacity (0.0 to 1.0)</span>
            </div>

            <div class="api-method">
                <strong>SetVisible(visible bool)</strong><br>
                <span class="text-muted">Sets the layer visibility</span>
            </div>

            <div class="api-method">
                <strong>GetBlendMode() BlendMode</strong><br>
                <span class="text-muted">Returns the current blend mode</span>
            </div>

            <div class="code-example">
<pre><code>// Layer properties
layer := lm.AddLayer("Effect Layer")

// Set blend mode
layer.SetBlendMode(advancegg.BlendModeMultiply)

// Set opacity (50% transparent)
layer.SetOpacity(0.5)

// Hide/show layer
layer.SetVisible(false)
layer.SetVisible(true)

// Get current properties
mode := layer.GetBlendMode()
opacity := layer.GetOpacity()
visible := layer.IsVisible()</code></pre>
            </div>
        </section>

        <!-- Advanced Compositing -->
        <section class="mb-5">
            <h2 class="h3 fw-bold mb-4">Advanced Compositing</h2>
            
            <div class="code-example">
<pre><code>// Complex layer composition example
func createComplexComposition(dc *advancegg.Context) {
    // Enable layers
    dc.EnableLayers()
    lm := dc.GetLayerManager()
    
    // Background layer
    bg := lm.GetActiveLayer()
    bg.Name = "Background"
    lm.SetActiveLayer(0)
    
    // Create gradient background
    gradient := advancegg.NewLinearGradient(0, 0, 400, 300)
    gradient.AddColorStop(0, color.RGBA{100, 150, 200, 255})
    gradient.AddColorStop(1, color.RGBA{200, 100, 150, 255})
    dc.SetFillStyle(gradient)
    dc.DrawRectangle(0, 0, 400, 300)
    dc.Fill()
    
    // Multiply layer for shadows
    shadowLayer := lm.AddLayer("Shadows")
    shadowLayer.SetBlendMode(advancegg.BlendModeMultiply)
    shadowLayer.SetOpacity(0.6)
    lm.SetActiveLayer(1)
    
    dc.SetRGBA(0, 0, 0, 0.5)
    dc.DrawCircle(220, 170, 80)
    dc.Fill()
    
    // Screen layer for highlights
    highlightLayer := lm.AddLayer("Highlights")
    highlightLayer.SetBlendMode(advancegg.BlendModeScreen)
    highlightLayer.SetOpacity(0.8)
    lm.SetActiveLayer(2)
    
    dc.SetRGBA(1, 1, 1, 0.7)
    dc.DrawCircle(180, 130, 60)
    dc.Fill()
    
    // Overlay layer for main content
    contentLayer := lm.AddLayer("Content")
    contentLayer.SetBlendMode(advancegg.BlendModeOverlay)
    lm.SetActiveLayer(3)
    
    dc.SetRGB(1, 0.5, 0.2)
    dc.DrawCircle(200, 150, 70)
    dc.Fill()
    
    // Composite all layers
    result := lm.Composite()
    return result
}</code></pre>
            </div>
        </section>

        <!-- Performance Notes -->
        <section class="mb-5">
            <h2 class="h3 fw-bold mb-4">Performance Considerations</h2>
            
            <div class="alert alert-info">
                <h5>Optimization Tips</h5>
                <ul class="mb-0">
                    <li><strong>Layer Count:</strong> Keep the number of layers reasonable (typically &lt; 20)</li>
                    <li><strong>Blend Modes:</strong> Normal mode is fastest, complex modes like Soft Light are slower</li>
                    <li><strong>Opacity:</strong> Fully opaque layers (1.0) are faster than transparent ones</li>
                    <li><strong>Compositing:</strong> Call Composite() only when needed, not every frame</li>
                    <li><strong>Memory:</strong> Large layers consume more memory; consider layer size optimization</li>
                </ul>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-light py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>AdvanceGG</h5>
                    <p class="text-muted">The ultimate 2D graphics library for Go developers.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="text-muted">&copy; 2024 AdvanceGG Contributors. MIT License.</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
